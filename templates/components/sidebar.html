<aside class="sidebar" id="sidebar">
    <div class="sidebar-user">
        <div class="user-avatar">
            <i class="fas fa-user"></i>
        </div>
        <div class="user-name">{{ user.first_name|default:user.username }}</div>
        <div class="user-role">
            {% if user.is_superuser %}
                <span class="badge badge-admin">Superuser</span>
            {% elif user.profile.role == 'admin' %}
                <span class="badge badge-admin">Quản trị viên</span>
            {% elif user.profile.role == 'citizenship_manager' %}
                <span class="badge badge-manager">Quản lý công dân</span>
            {% elif user.profile.role == 'commendation_manager' %}
                <span class="badge badge-manager">Quản lý khen thưởng</span>
            {% else %}
                <span class="badge badge-citizen">Người dân</span>
            {% endif %}
        </div>
    </div>
    
    <nav class="sidebar-menu">
        <div class="menu-section">Menu chính</div>
        
        <a href="{% url 'dashboard' %}" class="menu-item {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}">
            <i class="fas fa-home"></i>
            Trang chủ
        </a>
        
        {% comment %} Quản lý công dân - Hiện cho Admin và Citizenship Manager {% endcomment %}
        {% if user.is_superuser or user.profile.role == 'admin' or user.profile.role == 'citizenship_manager' %}
        <div class="menu-section">Quản lý công dân</div>
        
        <a href="{% url 'nhankhau_list' %}" class="menu-item {% if 'nhankhau' in request.path %}active{% endif %}">
            <i class="fas fa-users"></i>
            Nhân khẩu
        </a>
        
        <a href="{% url 'hokhau_list' %}" class="menu-item {% if 'hokhau' in request.path %}active{% endif %}">
            <i class="fas fa-house-user"></i>
            Hộ khẩu
        </a>
        
        <a href="{% url 'tamtru_list' %}" class="menu-item {% if 'tamtru' in request.path %}active{% endif %}">
            <i class="fas fa-suitcase"></i>
            Tạm trú - Tạm vắng
        </a>
        {% endif %}
        
        {% comment %} Quản lý khen thưởng - Hiện cho Admin và Commendation Manager {% endcomment %}
        {% if user.is_superuser or user.profile.role == 'admin' or user.profile.role == 'commendation_manager' %}
        <div class="menu-section">Quản lý khen thưởng</div>
        
        <a href="{% url 'khenthuong_list' %}" class="menu-item {% if 'khenthuong' in request.path %}active{% endif %}">
            <i class="fas fa-gift"></i>
            Khen thưởng
        </a>
        {% endif %}
        
        {% comment %} Citizen có thể xem thông tin (chỉ đọc) {% endcomment %}
        {% if user.profile.role == 'citizen' %}
        <div class="menu-section">Tra cứu</div>
        
        <a href="{% url 'nhankhau_list' %}" class="menu-item {% if 'nhankhau' in request.path %}active{% endif %}">
            <i class="fas fa-users"></i>
            Xem nhân khẩu
        </a>
        
        <a href="{% url 'hokhau_list' %}" class="menu-item {% if 'hokhau' in request.path %}active{% endif %}">
            <i class="fas fa-house-user"></i>
            Xem hộ khẩu
        </a>
        
        <a href="{% url 'khenthuong_list' %}" class="menu-item {% if 'khenthuong' in request.path %}active{% endif %}">
            <i class="fas fa-gift"></i>
            Xem khen thưởng
        </a>
        {% endif %}
        
        <div class="menu-section">Tài khoản</div>
        
        <a href="{% url 'profile' %}" class="menu-item {% if request.resolver_match.url_name == 'profile' %}active{% endif %}">
            <i class="fas fa-user-circle"></i>
            Thông tin cá nhân
        </a>
        
        <a href="{% url 'change_password' %}" class="menu-item {% if request.resolver_match.url_name == 'change_password' %}active{% endif %}">
            <i class="fas fa-key"></i>
            Đổi mật khẩu
        </a>
        
        {% comment %} Quản lý người dùng - Chỉ Admin {% endcomment %}
        {% if user.is_superuser or user.profile.role == 'admin' %}
        <div class="menu-section">Quản trị</div>
        
        <a href="{% url 'user_list' %}" class="menu-item {% if 'users/manage' in request.path %}active{% endif %}">
            <i class="fas fa-users-cog"></i>
            Quản lý người dùng
        </a>
        {% endif %}
        
        <div class="menu-logout">
            <a href="{% url 'logout' %}" class="menu-item">
                <i class="fas fa-sign-out-alt"></i>
                Đăng xuất
            </a>
        </div>
    </nav>
</aside>
