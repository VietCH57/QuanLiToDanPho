{% extends 'base.html' %}

{% block title %}T·∫°m tr√∫ - T·∫°m v·∫Øng - H·ªá th·ªëng Qu·∫£n l√Ω T·ªï D√¢n Ph·ªë{% endblock %}

{% block extra_css %}
<style>
    .page-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 40px 20px;
    }

    .page-header {
        text-align: center;
        margin-bottom: 40px;
    }

    .page-header h1 {
        color: #333;
        font-size: 36px;
        margin-bottom: 10px;
    }

    .action-cards {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 25px;
        margin-bottom: 50px;
    }

    .action-card {
        background: white;
        padding: 40px;
        border-radius: 15px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        text-decoration: none;
        display: block;
    }

    .action-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }

    .action-card.tam-tru {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        color: white;
    }

    .action-card.tam-vang {
        background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        color: white;
    }

    .action-card .icon {
        font-size: 60px;
        margin-bottom: 20px;
    }

    .action-card h3 {
        font-size: 24px;
        margin-bottom: 10px;
        color: white;
    }

    .action-card p {
        font-size: 14px;
        color: rgba(255,255,255,0.9);
    }

    .section-title {
        font-size: 24px;
        color: #333;
        margin: 40px 0 20px 0;
        padding-bottom: 10px;
        border-bottom: 3px solid #00f2fe;
    }

    .table-container {
        background: white;
        border-radius: 15px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        overflow: hidden;
        margin-bottom: 30px;
    }

    table {
        width: 100%;
        border-collapse: collapse;
    }

    thead {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
    }

    th {
        padding: 15px;
        text-align: left;
        font-weight: 600;
        font-size: 14px;
    }

    td {
        padding: 15px;
        border-bottom: 1px solid #f0f0f0;
    }

    tbody tr:hover {
        background: #f8f9fa;
    }

    .badge {
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        display: inline-block;
    }

    .badge.cho-duyet {
        background: #fff3cd;
        color: #856404;
    }

    .badge.da-duyet {
        background: #d4edda;
        color: #155724;
    }

    .badge.tu-choi {
        background: #f8d7da;
        color: #721c24;
    }

    .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: #999;
    }

    .empty-state .icon {
        font-size: 80px;
        margin-bottom: 20px;
        opacity: 0.3;
    }

    .btn-back {
        display: inline-block;
        margin-top: 30px;
        padding: 12px 30px;
        background: #667eea;
        color: white;
        border-radius: 8px;
        text-decoration: none;
        transition: all 0.3s ease;
    }

    .btn-back:hover {
        background: #5568d3;
        transform: translateY(-2px);
    }

    .btn-detail {
        padding: 6px 15px;
        background: #667eea;
        color: white;
        border-radius: 5px;
        text-decoration: none;
        font-size: 13px;
        transition: all 0.3s ease;
    }

    .btn-detail:hover {
        background: #5568d3;
    }
</style>
{% endblock %}

{% block content %}
<div class="page-container">
    <div class="page-header">
        <h1>T·∫°m tr√∫ - T·∫°m v·∫Øng</h1>
        <p style="color: #666;">Khai b√°o t·∫°m tr√∫ v√† t·∫°m v·∫Øng</p>
    </div>

    {% if not is_manager %}
    <div class="action-cards">
        <a href="{% url 'users:khai_bao_tam_tru' %}" class="action-card tam-tru">
            <div class="icon">üìù</div>
            <h3>Khai b√°o T·∫°m tr√∫</h3>
            <p>ƒêƒÉng k√Ω t·∫°m tr√∫ t·∫°i ƒë·ªãa ph∆∞∆°ng</p>
        </a>

        <a href="{% url 'users:khai_bao_tam_vang' %}" class="action-card tam-vang">
            <div class="icon">‚úàÔ∏è</div>
            <h3>Khai b√°o T·∫°m v·∫Øng</h3>
            <p>Th√¥ng b√°o t·∫°m v·∫Øng kh·ªèi n∆°i c∆∞ tr√∫</p>
        </a>
    </div>
    {% endif %}

    <!-- Danh s√°ch ƒë∆°n t·∫°m tr√∫ -->
    <h2 class="section-title">Danh s√°ch ƒë∆°n T·∫°m tr√∫</h2>
    <div class="table-container">
        {% if don_tam_tru %}
        <table>
            <thead>
                <tr>
                    <th>H·ªç t√™n</th>
                    <th>N∆°i t·∫°m tr√∫</th>
                    <th>Ng√†y b·∫Øt ƒë·∫ßu</th>
                    <th>Ng√†y t·∫°o ƒë∆°n</th>
                    <th>Tr·∫°ng th√°i</th>
                    <th>Thao t√°c</th>
                </tr>
            </thead>
            <tbody>
                {% for don in don_tam_tru %}
                <tr>
                    <td>{{ don.ho_ten }}</td>
                    <td>{{ don.noi_tam_tru|truncatewords:5 }}</td>
                    <td>{{ don.ngay_bat_dau|default:"Ch∆∞a x√°c ƒë·ªãnh" }}</td>
                    <td>{{ don.ngay_tao|date:"d/m/Y H:i" }}</td>
                    <td>
                        {% if don.trang_thai == 'ChoDuyet' %}
                            <span class="badge cho-duyet">Ch·ªù duy·ªát</span>
                        {% elif don.trang_thai == 'DaDuyet' %}
                            <span class="badge da-duyet">ƒê√£ duy·ªát</span>
                        {% else %}
                            <span class="badge tu-choi">T·ª´ ch·ªëi</span>
                        {% endif %}
                    </td>
                    <td>
                        <a href="{% url 'users:chi_tiet_tam_tru' don.id %}" class="btn-detail">{% if is_manager %}Chi ti·∫øt{% else %}Xem ƒë∆°n{% endif %}</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <div class="empty-state">
            <div class="icon">üì≠</div>
            <h3>Ch∆∞a c√≥ ƒë∆°n t·∫°m tr√∫</h3>
            <p>{% if not is_manager %}B·∫°n ch∆∞a c√≥ ƒë∆°n t·∫°m tr√∫ n√†o.{% else %}Ch∆∞a c√≥ ƒë∆°n t·∫°m tr√∫ n√†o trong h·ªá th·ªëng.{% endif %}</p>
        </div>
        {% endif %}
    </div>

    <!-- Danh s√°ch ƒë∆°n t·∫°m v·∫Øng -->
    <h2 class="section-title">Danh s√°ch ƒë∆°n T·∫°m v·∫Øng</h2>
    <div class="table-container">
        {% if don_tam_vang %}
        <table>
            <thead>
                <tr>
                    <th>H·ªç t√™n</th>
                    <th>N∆°i ƒë·∫øn</th>
                    <th>T·ª´ ng√†y</th>
                    <th>ƒê·∫øn ng√†y</th>
                    <th>Ng√†y t·∫°o ƒë∆°n</th>
                    <th>Tr·∫°ng th√°i</th>
                    <th>Thao t√°c</th>
                </tr>
            </thead>
            <tbody>
                {% for don in don_tam_vang %}
                <tr>
                    <td>{{ don.ho_ten }}</td>
                    <td>{{ don.noi_den|truncatewords:5 }}</td>
                    <td>{{ don.ngay_bat_dau|default:"Ch∆∞a x√°c ƒë·ªãnh" }}</td>
                    <td>{{ don.ngay_ket_thuc|default:"Ch∆∞a x√°c ƒë·ªãnh" }}</td>
                    <td>{{ don.ngay_tao|date:"d/m/Y H:i" }}</td>
                    <td>
                        {% if don.trang_thai == 'ChoDuyet' %}
                            <span class="badge cho-duyet">Ch·ªù duy·ªát</span>
                        {% elif don.trang_thai == 'DaDuyet' %}
                            <span class="badge da-duyet">ƒê√£ duy·ªát</span>
                        {% else %}
                            <span class="badge tu-choi">T·ª´ ch·ªëi</span>
                        {% endif %}
                    </td>
                    <td>
                        <a href="{% url 'users:chi_tiet_tam_vang' don.id %}" class="btn-detail">{% if is_manager %}Chi ti·∫øt{% else %}Xem ƒë∆°n{% endif %}</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <div class="empty-state">
            <div class="icon">üì≠</div>
            <h3>Ch∆∞a c√≥ ƒë∆°n t·∫°m v·∫Øng</h3>
            <p>{% if not is_manager %}B·∫°n ch∆∞a c√≥ ƒë∆°n t·∫°m v·∫Øng n√†o.{% else %}Ch∆∞a c√≥ ƒë∆°n t·∫°m v·∫Øng n√†o trong h·ªá th·ªëng.{% endif %}</p>
        </div>
        {% endif %}
    </div>

    <div style="text-align: center;">
        <a href="{% url 'users:dashboard' %}" class="btn-back">
            ‚Üê Quay l·∫°i Trang ch·ªß
        </a>
    </div>
</div>
{% endblock %}
